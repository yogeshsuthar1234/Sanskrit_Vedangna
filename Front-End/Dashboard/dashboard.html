<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spiritual Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
<link rel="stylesheet" href="./dashboard.css" >
<script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
<script>
tailwind.config = {
theme: {
extend: {
colors: {
primary: '#FF6B6B',
secondary: '#4ECDC4'
},
borderRadius: {
'none': '0px',
'sm': '4px',
DEFAULT: '8px',
'md': '12px',
'lg': '16px',
'xl': '20px',
'2xl': '24px',
'3xl': '32px',
'full': '9999px',
'button': '8px'
}
}
}
}
</script>
<style>   /* Mobile Menu Enhancements */
.progress-bar {
    transition: width 1s ease-in-out;
}

  .menu-toggle {
      display: none;
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #FF6B6B;
  }
  
  @media (max-width: 640px) {
      .menu-toggle { display: block; }
      .menu-items {
          display: none;
          width: 100%;
          text-align: center;
          padding: 1rem 0;
      }
      .menu-open .menu-items {
          display: flex;
          flex-direction: column;
          gap: 1rem;
      }
  }

  /* Rotating Circles Mobile Optimization */
  @media (max-width: 768px) {
      #rotating-circles {
          transform: scale(0.8);
      }
      
      .rotating-circle .tooltip {
          left: 50% !important;
          top: 110% !important;
          transform: translateX(-50%);
          margin-left: 0 !important;
          width: 200px;
      }
  }

  /* Expertise Cards Mobile Tweaks */
  @media (max-width: 640px) {
      .expertise-card {
          padding: 1.5rem;
      }
      
      .expertise-card h3 {
          font-size: 1.1rem;
      }
      
      .expertise-card p {
          font-size: 0.9rem;
      }
  }

  /* Footer Adjustments */
  @media (max-width: 640px) {
      footer .grid {
          gap: 2rem;
      }
      
      footer h3 {
          font-size: 1.1rem;
      }
  }
  .progress-bar {
    transition: width 1s ease-in-out;
    width: 0; /* Initial state */
}
</style>
</head>
<body class="bg-white min-h-screen">
<header class="bg-gradient-to-r from-primary/10 to-secondary/10 py-4">
<nav class="container mx-auto px-4">
<div class="flex flex-col sm:flex-row items-center justify-between gap-4 sm:gap-0">
<div class="text-3xl font-['Pacifico']">Vedangana</div>
<div class="flex flex-wrap justify-center gap-4 sm:gap-6">
<a href="#" class="hover:text-primary transition-colors">Home</a>
<a href="../Quiz/QuizMaster.html" class="hover:text-primary transition-colors">QuizMaster</a>
<a href="./user.html" class="hover:text-primary transition-colors">User</a>
</div>
</div>
</nav>
</header>

<main class="container mx-auto px-4 py-8">
  
<div class="relative h-[400px] sm:h-[500px] md:h-[600px] lg:h-[700px] flex items-center justify-center mb-16">
<div class="w-32 h-32 sm:w-48 sm:h-48 md:w-64 md:h-64 rounded-full bg-gradient-to-r from-primary/20 to-secondary/20 flex items-center justify-center shadow-lg float-animation">
<img src="https://public.readdy.ai/ai/img_res/0876eb840b43cff7ee315c751f9ff10e.jpg"
alt="Lord Shiva"
class="w-24 h-24 sm:w-40 sm:h-40 md:w-56 md:h-56 rounded-full object-cover">
</div>
<div id="rotating-circles" class="absolute inset-0"></div>
</div>
<section class="mb-16">
<h2 class="text-3xl font-bold mb-8 text-center">Professional Expertise</h2>
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 p-4">
<div class="expertise-card p-6 rounded-lg bg-white shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
<div class="w-12 h-12 flex items-center justify-center rounded-full bg-primary/10 mb-4">
<i class="ri-book-open-line text-xl text-primary"></i>
</div>
<a href="../DailyExclusive/VedicStudies.html" class="mt-4 inline-flex items-center text-primary hover:text-primary/80 transition-colors duration-200">
    Try Now
    <i class="ri-arrow-right-line ml-2"></i>
</a>
<h3 class="text-xl font-semibold mb-4 flex items-center gap-2">
Vedic Studies
</h3>
<p class="text-gray-600 mb-6">Advanced understanding of ancient Vedic texts and their practical applications in modern life.</p>
<div class="relative">
<div class="h-2 bg-gray-100 rounded-full overflow-hidden">
<div class="progress-bar h-full bg-gradient-to-r from-primary to-secondary rounded-full w-0" style="--progress: 85%"></div>
</div>
<span class="absolute -right-2 -top-6 text-sm font-medium">85%</span>
</div>
</div>
<div class="expertise-card p-6 rounded-lg bg-white shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
<div class="w-12 h-12 flex items-center justify-center rounded-full bg-primary/10 mb-4">
<i class="ri-mind-map-line text-xl text-primary"></i>

</div>
<a href="../DailyExclusive/Yoga.html" class="mt-4 inline-flex items-center text-primary hover:text-primary/80 transition-colors duration-200">
    Try Now
    <i class="ri-arrow-right-line ml-2"></i>
</a>
<h3 class="text-xl font-semibold mb-4">Meditation Techniques</h3>
<p class="text-gray-600 mb-6">Expert guidance in various meditation practices for mental clarity and spiritual growth.</p>
<div class="relative">
<div class="h-2 bg-gray-100 rounded-full overflow-hidden">
<div class="progress-bar h-full bg-gradient-to-r from-primary to-secondary rounded-full w-0" style="--progress: 5%"></div>

</div>
<span class="absolute -right-2 -top-6 text-sm font-medium">92%</span>
</div>
</div>
<div class="expertise-card p-6 rounded-lg bg-white shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
<div class="w-12 h-12 flex items-center justify-center rounded-full bg-primary/10 mb-4">
<i class="ri-yoga-line text-xl text-primary"></i>
</div>
<a href="../DailyExclusive/yogaphilo.html" class="mt-4 inline-flex items-center text-primary hover:text-primary/80 transition-colors duration-200">
    Try Now
    <i class="ri-arrow-right-line ml-2"></i>
</a>
<h3 class="text-xl font-semibold mb-4">Yoga Philosophy</h3>
<p class="text-gray-600 mb-6">Deep knowledge of yogic principles and their integration into daily spiritual practice.</p>
<div class="relative">
<div class="h-2 bg-gray-100 rounded-full overflow-hidden">
<div class="progress-bar h-full bg-gradient-to-r from-primary to-secondary rounded-full w-0" style="--progress: 78%"></div>
</div>
<span class="absolute -right-2 -top-6 text-sm font-medium">78%</span>
</div>
</div>
<div class="expertise-card p-6 rounded-lg bg-white shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
<div class="w-12 h-12 flex items-center justify-center rounded-full bg-primary/10 mb-4">
<i class="ri-mental-health-line text-xl text-primary"></i>
</div>
<a href="../DailyExclusive/spiritual.html" class="mt-4 inline-flex items-center text-primary hover:text-primary/80 transition-colors duration-200">
    Try Now
    <i class="ri-arrow-right-line ml-2"></i>
</a>
<h3 class="text-xl font-semibold mb-4">Spiritual Counseling</h3>
<p class="text-gray-600 mb-6">Professional guidance for personal transformation and spiritual awakening journey.</p>
<div class="relative">
<div class="h-2 bg-gray-100 rounded-full overflow-hidden">
<div class="progress-bar h-full bg-gradient-to-r from-primary to-secondary rounded-full w-0" style="--progress: 88%"></div>
</div>
<span class="absolute -right-2 -top-6 text-sm font-medium">88%</span>
</div>
</div>
<div class="expertise-card p-6 rounded-lg bg-white shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
<div class="w-12 h-12 flex items-center justify-center rounded-full bg-primary/10 mb-4">
<i class="ri-ancient-pavilion-line text-xl text-primary"></i>
</div>
<a href="../DailyExclusive/TempleRituals.html" class="mt-4 inline-flex items-center text-primary hover:text-primary/80 transition-colors duration-200">
    Try Now
    <i class="ri-arrow-right-line ml-2"></i>
</a>
<h3 class="text-xl font-semibold mb-4">Temple Rituals</h3>
<p class="text-gray-600 mb-6">Extensive knowledge of traditional temple ceremonies and sacred rituals.</p>
<div class="relative">
<div class="h-2 bg-gray-100 rounded-full overflow-hidden">
<div class="progress-bar h-full bg-gradient-to-r from-primary to-secondary rounded-full w-0" style="--progress: 95%"></div>
</div>
<span class="absolute -right-2 -top-6 text-sm font-medium">95%</span>
</div>
</div>
<div class="expertise-card p-6 rounded-lg bg-white shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
<div class="w-12 h-12 flex items-center justify-center rounded-full bg-primary/10 mb-4">
<i class="ri-sun-line text-xl text-primary"></i>
</div>
<a href="../DailyExclusive/energyhealing.html" class="mt-4 inline-flex items-center text-primary hover:text-primary/80 transition-colors duration-200">
    Try Now
    <i class="ri-arrow-right-line ml-2"></i>
</a>
<h3 class="text-xl font-semibold mb-4">Energy Healing</h3>
<p class="text-gray-600 mb-6">Mastery in ancient energy healing techniques and chakra balancing methods.</p>
<div class="relative">
<div class="h-2 bg-gray-100 rounded-full overflow-hidden">
<div class="progress-bar h-full bg-gradient-to-r from-primary to-secondary rounded-full w-0" style="--progress: 82%"></div>
</div>
<span class="absolute -right-2 -top-6 text-sm font-medium">82%</span>
</div>
</div>
</div>
</section>
</main>
<footer class="bg-gradient-to-r from-primary/10 to-secondary/10 py-8">
<div class="container mx-auto px-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 p-4">
<div>
<h3 class="text-xl font-semibold mb-4">About Us</h3>
<p class="text-gray-600">Dedicated to spreading spiritual knowledge and wisdom through ancient teachings and modern understanding.</p>
</div>
<div>
<h3 class="text-xl font-semibold mb-4">Quick Links</h3>
<ul class="space-y-2">
<li><a href="#" class="text-gray-600 hover:text-primary">Services</a></li>
<li><a href="#" class="text-gray-600 hover:text-primary">Resources</a></li>
<li><a href="#" class="text-gray-600 hover:text-primary">Blog</a></li>
<li><a href="#" class="text-gray-600 hover:text-primary">Contact</a></li>
</ul>
</div>
<div>
<h3 class="text-xl font-semibold mb-4">Connect With Us</h3>
<div class="flex gap-4">
<a href="#" class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center hover:bg-primary/20">
<i class="ri-facebook-fill text-primary"></i>
</a>
<a href="#" class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center hover:bg-primary/20">
<i class="ri-twitter-fill text-primary"></i>
</a>
<a href="#" class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center hover:bg-primary/20">
<i class="ri-instagram-fill text-primary"></i>
</a>
</div>
</div>
</div>
</footer>

    <!-- Chat Bot Components -->
    <div class="fixed bottom-8 right-8 z-50">
      <button id="chatToggle" class="bg-primary text-white p-4 rounded-full shadow-lg hover:bg-secondary transition-all w-16 h-16 flex items-center justify-center">
          <i class="fas fa-comments text-xl"></i>
      </button>
  </div>

  <div id="chatContainer" class="fixed bottom-24 right-8 w-full max-w-md bg-white rounded-xl shadow-xl hidden flex-col" style="height: 70vh; max-height: 70vh;">
      <div class="bg-primary text-white p-4 rounded-t-xl flex items-center justify-between">
          <h2 class="text-xl font-semibold">संस्कृत सहायक</h2>
          <button id="closeChat" class="hover:text-secondary">
              <i class="fas fa-times text-lg"></i>
          </button>
      </div>
      
      <div id="chatHistory" class="flex-1 p-4 overflow-y-auto space-y-3" style="max-height: calc(70vh - 130px);">
          <!-- Chat messages appear here -->
      </div>

      <div class="p-4 border-t">
          <div class="flex gap-2">
              <input id="userInput" type="text" 
                     class="flex-1 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                     placeholder="Ask your question...">
              <button onclick="sendMessage()" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-secondary transition-colors">
                  <i class="fas fa-paper-plane"></i>
              </button>
          </div>
      </div>
  </div>
  <div id="toast" class="toast"></div>
      <script>
        // Chat Functionality
        let chatHistory = JSON.parse(localStorage.getItem('sanskritChat')) || [];

        document.getElementById('chatToggle').addEventListener('click', () => {
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.classList.toggle('hidden');
            loadChatHistory();
        });

        document.getElementById('closeChat').addEventListener('click', () => {
            document.getElementById('chatContainer').classList.add('hidden');
        });

        function loadChatHistory() {
            const historyDiv = document.getElementById('chatHistory');
            historyDiv.innerHTML = chatHistory.map(msg => `
                <div class="${msg.role === 'user' ? 'text-right' : 'text-left'} message-enter">
                    <div class="${msg.role === 'user' ? 'bg-primary/10' : 'bg-gray-100'} 
                        inline-block p-3 rounded-lg max-w-[90%] chat-message">
                        ${marked.parse(msg.content)}
                        <div class="text-xs text-gray-500 timestamp">
                            ${new Date(msg.timestamp).toLocaleTimeString()}
                        </div>
                    </div>
                </div>
            `).join('');
            historyDiv.scrollTo(0, historyDiv.scrollHeight);
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            if (!message) return;
            input.value = '';

            chatHistory.push({ role: 'user', content: message, timestamp: new Date().toISOString() });

            chatHistory.push({ role: 'assistant', content: 'प्रतीक्षा कुरु...', timestamp: new Date().toISOString() });
            loadChatHistory();

            try {
    const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer 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',
    },
      body: JSON.stringify({
        model: 'meta-llama/llama-4-scout:free',
               messages: [{ role: 'user', content: message }],
                    }),
                });

                
                const data = await response.json();
                console.log("data"+data);
                const botResponse = data.choices?.[0]?.message?.content || 'उत्तरं प्राप्तुं अशक्यम्';

                chatHistory.pop();
                chatHistory.push({ role: 'assistant', content: botResponse, timestamp: new Date().toISOString() });
                localStorage.setItem('sanskritChat', JSON.stringify(chatHistory));
                loadChatHistory();
            } catch (error) {
                console.error('Error:', error);
                chatHistory.pop();
                chatHistory.push({ role: 'assistant', content: 'त्रुटिः! पुनः प्रयत्नं कुरुत।', timestamp: new Date().toISOString() });
                loadChatHistory();
            }
        }

        document.getElementById('userInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });

        // Rotating Circles
        
        // Intersection Observer for expertise cards
        const observerOptions = {
            threshold: 0.1
        };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.classList.add('visible');
                    }, index * 200);
                }
            });
        }, observerOptions);
        document.querySelectorAll('.expertise-card').forEach(card => {
            observer.observe(card);
            card.querySelector('.progress-bar').style.width = '0';
        });

        // Toast notification
        async function showToast(message, type) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.style.display = 'block';
            await new Promise(resolve => setTimeout(resolve, 2000));
            toast.style.display = 'none';
        }

        // Fetch progress data
        async function fetchProgress() {
            try {
                const userId = localStorage.getItem('userId');
                if (!userId) {
                  
                    await showToast('Please log in to view progress', 'error');
                    setTimeout(() => window.location.href = '../login/Login.html', 2000);
                    return;
                }
                console.log("hi");
                const response = await fetch('https://sanskrit-vedangna.onrender.com/api/progress/current-progress', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-User-Id': userId
                    }
                });
                    console.log('hi2');
                if (!response.ok) {
                    const data = await response.json();
                  
                    throw new Error(data.message || 'Failed to fetch progress');
                }

                const data = await response.json();
                console.log(data);
                updateProgressBars(data);

                // Update expertise cards with progress
             } catch (error) {
                console.log("bye");
               // await showToast(error.message || 'Error fetching progress', 'error');
                document.getElementById('progress').innerHTML = '<p class="text-red-500">Failed to load progress</p>';
            }
        }

        function updateProgressBars(progressData) {

        const vedaData = progressData.veda || {};
        const container = document.getElementById('rotating-circles');
        
        const circles = [
            { label: 'Vedangas', info: 'The oldest of the Vedas, containing hymns to various deities' },
            { label: 'Samhitas', info: 'Collection of melodies and chants' },
            { label: 'Aranyakas', info: 'Prose mantras for ritual worship' },
            { label: 'Brahmanas', info: 'Spells and incantations for everyday life' },
            { label: 'Ayurveda', info: 'Traditional medicine and healing' },
            { label: 'Dhanurveda', info: 'Military science and martial arts' },
            { label: 'Upanishad', info: 'Music and performing arts' },
            { label: 'Upveda', info: 'Architecture and engineering' },
            { label: 'Shilpa', info: 'Arts and crafts' },
            { label: 'Natya', info: 'Drama and dance' }
        ];

        circles.forEach((circle, index) => {
            const angle = (index / circles.length) * 2 * Math.PI;
            const delay = -index * (20 / circles.length);
            const div = document.createElement('div');
            div.className = 'rotating-circle';
            div.style.animationDelay = `${delay}s`;

            // Get progress from API data or default to 0
            const progress = vedaData[circle.label]?.progressPercentage || 0;

            div.innerHTML = `
                <a href="../Veda/${circle.label}/${circle.label}.html" 
                   data-readdy="true" 
                   class="block">
                    <div class="w-20 h-20 bg-white rounded-full shadow-lg flex items-center justify-center relative cursor-pointer">
                        <span class="text-sm font-medium text-center">${circle.label}</span>
                        <div class="tooltip absolute left-full ml-4 w-64 p-4 bg-white rounded-lg shadow-xl">
                            <h4 class="font-semibold mb-2">${circle.label}</h4>
                            <p class="text-sm text-gray-600 mb-2">${circle.info}</p>
                            <div class="h-2 bg-gray-200 rounded-full relative overflow-hidden">
                                <div class="progress-bar h-full bg-gradient-to-r from-primary to-secondary rounded-full" 
                                     style="width: ${progress}%"></div>
                                <span class="absolute -right-7 -top-6 text-sm font-medium">${progress}%</span>
                            </div>
                        </div>
                    </div>
                </a>
            `;

            // Add hover interactions
            div.addEventListener('mouseenter', () => {
                document.querySelectorAll('.rotating-circle').forEach(c => {
                    c.classList.add('paused');
                });
                div.querySelector('.progress-bar').style.width = `${progress}%`;
            });

            div.addEventListener('mouseleave', () => {
                document.querySelectorAll('.rotating-circle').forEach(c => {
                    c.classList.remove('paused');
                });
                div.querySelector('.progress-bar').style.width = `${progress}%`;
            });

            container.appendChild(div);
        });

    
    document.querySelectorAll('.expertise-card').forEach(card => {
        const title = card.querySelector('h3').textContent.trim();
        const progressBar = card.querySelector('.progress-bar');
        const percentageSpan = card.querySelector('.text-sm.font-medium');
        
        // Find matching course or service
        const course = progressData.courses[title];
        const service = progressData.services[title];
        
        console.log(course + " ...... "+service);
        let progress = 0;
        
        if (course) {
            // Handle course progress
            progress = +(course.progressPercentage.toFixed(2));
        } else if (service) {
            // Convert service usage to percentage (1 usage = 10%)
            progress = Math.min(service.usageCount * 10, 100);
        }
        
        // Animate progress bar style="--progress: 5%"
        progressBar.style.width = '0';
        setTimeout(() => {
            progressBar.style = `--progress: ${progress}%`;
            percentageSpan.textContent = `${progress}%`;
            
            // Optional: Add color transition
            progressBar.style.transition = 'width 1s ease-in-out';
        }, 100);
    });
}

        // Call on page load
        document.addEventListener('DOMContentLoaded', fetchProgress);
    </script>
</body>
</html>